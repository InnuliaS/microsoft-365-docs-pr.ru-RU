---
title: Сведения о ключе доступности для ключа клиента Office 365
ms.author: krowley
author: kccross
manager: laurawi
ms.date: 02/05/2020
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
description: Сведения о ключе доступности, используемом для восстановления потерянных ключей клиентов Office 365.
ms.openlocfilehash: 86f602a59f436a6ce42df583c88c0403eb17e5ae
ms.sourcegitcommit: 3dd9944a6070a7f35c4bc2b57df397f844c3fe79
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/15/2020
ms.locfileid: "42076962"
---
# <a name="learn-about-the-availability-key-for-office-365-customer-key"></a><span data-ttu-id="48265-103">Сведения о ключе доступности для ключа клиента Office 365</span><span class="sxs-lookup"><span data-stu-id="48265-103">Learn about the availability key for Office 365 Customer Key</span></span>

<span data-ttu-id="48265-104">Ключ доступности — это корневой ключ, автоматически создаваемый и подготовленный при создании политики шифрования данных.</span><span class="sxs-lookup"><span data-stu-id="48265-104">The availability key is a root key automatically generated and provisioned when you create a data encryption policy.</span></span> <span data-ttu-id="48265-105">Office 365 сохраняет и защищает ключ доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-105">Office 365 stores and protects the availability key.</span></span> <span data-ttu-id="48265-106">Ключ доступности функционально аналогичен двум корневым ключам, которые вы указали для шифрования службы с помощью ключа клиента.</span><span class="sxs-lookup"><span data-stu-id="48265-106">The availability key is functionally like the two root keys that you supply for service encryption with Customer Key.</span></span> <span data-ttu-id="48265-107">Ключ доступности включает в себя перенос ключей на один уровень ниже в иерархии ключей.</span><span class="sxs-lookup"><span data-stu-id="48265-107">The availability key wraps the keys one tier lower in the key hierarchy.</span></span> <span data-ttu-id="48265-108">В отличие от ключей, предоставляемых и управляемых в Azure Key Vault, вы не можете напрямую получить доступ к ключу доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-108">Unlike the keys that you provide and manage in Azure Key Vault, you can't directly access the availability key.</span></span> <span data-ttu-id="48265-109">Автоматизированные службы Office 365 управляют ключом доступности с помощью командлетов PowerShell.</span><span class="sxs-lookup"><span data-stu-id="48265-109">Office 365 automated services manage the availability key using PowerShell cmdlets.</span></span> <span data-ttu-id="48265-110">Эти командлеты инициируют автоматические операции, которые никогда не задействуют прямой доступ к ключу доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-110">These cmdlets initiate automated operations that never involve direct access to the availability key.</span></span>

<span data-ttu-id="48265-111">Основная цель ключа доступности заключается в предоставлении возможности восстановления от непредвиденного потери корневых ключей, которыми вы управляете.</span><span class="sxs-lookup"><span data-stu-id="48265-111">The primary purpose of the availability key is to provide recovery capability from the unanticipated loss of root keys that you manage.</span></span> <span data-ttu-id="48265-112">Потеря может быть следствием неправильного управления или вредоносных действий.</span><span class="sxs-lookup"><span data-stu-id="48265-112">Loss could be a result of mismanagement or malicious action.</span></span> <span data-ttu-id="48265-113">Если вы потеряли контроль над корневыми ключами, обратитесь в службу поддержки Майкрософт, а Майкрософт поможет вам выполнить процесс восстановления с помощью ключа доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-113">If you lose control of your root keys, contact Microsoft Support and Microsoft will assist you through the process of recovery using the availability key.</span></span> <span data-ttu-id="48265-114">Ключ доступности используется для перехода на новую политику шифрования данных с новыми корневыми ключами, которые вы предоставиме.</span><span class="sxs-lookup"><span data-stu-id="48265-114">You'll use the availability key to migrate to a new Data Encryption Policy with new root keys you provision.</span></span>

<span data-ttu-id="48265-115">Хранение и контроль ключа доступности, как это сделано, отличается от ключей Azure Key Vault по трем причинам:</span><span class="sxs-lookup"><span data-stu-id="48265-115">Storage and control of the availability key are deliberately different from Azure Key Vault keys for three reasons:</span></span>

- <span data-ttu-id="48265-116">Ключ доступности обеспечивает возможность восстановления, "разбивки на стекла", если управление ключами Azure Key Vault теряется.</span><span class="sxs-lookup"><span data-stu-id="48265-116">The availability key provides a recovery, "break-glass" capability if control over both Azure Key Vault keys is lost.</span></span>
- <span data-ttu-id="48265-117">Разделение логических элементов управления и защищенные места хранения обеспечивают глубокую защиту и защищает от потери всех ключей и данных от одной атаки или точки отказа.</span><span class="sxs-lookup"><span data-stu-id="48265-117">The separation of logical controls and secure storage locations provides defense-in-depth and protects against the loss of all keys, and your data, from a single attack or point of failure.</span></span>
- <span data-ttu-id="48265-118">Ключ доступности предоставляет возможность высокого уровня доступности, если службы Office 365 не могут получить доступ к ключам, размещенным в Azure Key Vault из-за временных ошибок.</span><span class="sxs-lookup"><span data-stu-id="48265-118">The availability key provides a high-availability capability if Office 365 services are unable to reach keys hosted in Azure Key Vault due to transient errors.</span></span> <span data-ttu-id="48265-119">Это правило применяется только к службе шифрования Exchange Online и Skype для бизнеса.</span><span class="sxs-lookup"><span data-stu-id="48265-119">This rule only applies to Exchange Online and Skype for Business service encryption.</span></span> <span data-ttu-id="48265-120">Файлы SharePoint Online, OneDrive для бизнеса и Teams никогда не используют ключ доступности, если вы явно не укажете корпорации Майкрософт начать процесс восстановления.</span><span class="sxs-lookup"><span data-stu-id="48265-120">SharePoint Online, OneDrive for Business, and Teams files never use the availability key unless you explicitly instruct Microsoft to initiate the recovery process.</span></span>

<span data-ttu-id="48265-121">Совместное использование полномочий для защиты данных с помощью различных средств защиты и процессов для управления ключами, в конечном итоге уменьшает риск потери или уничтожения всех ключей (и, следовательно, данных).</span><span class="sxs-lookup"><span data-stu-id="48265-121">Sharing the responsibility to protect your data, using a variety of protections and processes for key management, ultimately reduces the risk that all keys (and therefore your data) will be permanently lost or destroyed.</span></span> <span data-ttu-id="48265-122">Корпорация Майкрософт предоставляет единственный контроль за невозможность или уничтожение ключа доступности при выходе из службы.</span><span class="sxs-lookup"><span data-stu-id="48265-122">Microsoft provides you with sole authority over the disablement or destruction of the availability key when you leave the service.</span></span> <span data-ttu-id="48265-123">По дизайну никто из Майкрософт не имеет доступа к ключу доступности: он доступен только в коде службы Office 365.</span><span class="sxs-lookup"><span data-stu-id="48265-123">By design, no one at Microsoft has access to the availability key: it is only accessible by Office 365 service code.</span></span>

<span data-ttu-id="48265-124">Дополнительные сведения о ключах безопасности можно найти в [центре управления безопасностью Майкрософт](https://www.microsoft.com/trustcenter/Privacy/govt-requests-for-data) .</span><span class="sxs-lookup"><span data-stu-id="48265-124">See the [Microsoft Trust Center](https://www.microsoft.com/trustcenter/Privacy/govt-requests-for-data) for more information about how we secure keys.</span></span>
  
## <a name="availability-key-uses"></a><span data-ttu-id="48265-125">Ключ доступности использует</span><span class="sxs-lookup"><span data-stu-id="48265-125">Availability key uses</span></span>

<span data-ttu-id="48265-126">Ключ доступности обеспечивает возможность восстановления для сценариев, в которых внешняя малефактор или вредоносная функция, которая позволяет злоумышленнику получить контроль над вашим ключевыми сведениями, или при непреднамеренном неправильном управлении приводить к потере корневых ключей.</span><span class="sxs-lookup"><span data-stu-id="48265-126">The availability key provides recovery capability for scenarios in which an external malefactor or malicious insider steals control of your key vault, or when inadvertent mismanagement results in loss of root keys.</span></span> <span data-ttu-id="48265-127">Эта возможность восстановления применяется ко всем службам Office 365, совместимым с ключом клиента.</span><span class="sxs-lookup"><span data-stu-id="48265-127">This recovery capability applies to all Office 365 services compatible with Customer Key.</span></span> <span data-ttu-id="48265-128">Отдельные службы используют ключ доступности по-разному.</span><span class="sxs-lookup"><span data-stu-id="48265-128">Individual services use the availability key differently.</span></span> <span data-ttu-id="48265-129">В Office 365 только ключ доступности используется в описанных ниже случаях.</span><span class="sxs-lookup"><span data-stu-id="48265-129">Office 365 only uses the availability key in the ways described below.</span></span>

### <a name="exchange-online-and-skype-for-business-uses"></a><span data-ttu-id="48265-130">Использование Exchange Online и Skype для бизнеса</span><span class="sxs-lookup"><span data-stu-id="48265-130">Exchange Online and Skype for Business uses</span></span>

<span data-ttu-id="48265-131">В дополнение к возможностям восстановления, Exchange Online и Skype для бизнеса используют ключ доступности для обеспечения доступности данных во время временной или периодически работающей операционной системы, связанной со службой, обращающейся к корневым ключам.</span><span class="sxs-lookup"><span data-stu-id="48265-131">In addition to the recovery capability, Exchange Online and Skype for Business use the availability key to ensure data availability during transient, or intermittent operational issues, related to the service accessing root keys.</span></span> <span data-ttu-id="48265-132">Если служба не может связаться ни с одним из ключей клиента в Azure Key Vault из-за временных ошибок, служба автоматически использует ключ доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-132">When the service cannot reach either of your Customer Keys in Azure Key Vault due to transient errors, the service automatically uses the availability key.</span></span> <span data-ttu-id="48265-133">Служба никогда не передается непосредственно в ключ доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-133">The service NEVER goes directly to the availability key.</span></span>

<span data-ttu-id="48265-134">Автоматические системы в Exchange Online и Skype для бизнеса могут использовать ключ доступности во время временных ошибок для поддержки автоматических внутренних служб, таких как защита от вирусов, обнаружения вирусов, защита от потери данных, перемещение почтовых ящиков и индексирование данных.</span><span class="sxs-lookup"><span data-stu-id="48265-134">Automated systems in Exchange Online and Skype for Business may use the availability key during transient errors to support automated back-end services such as anti-virus, e-discovery, data loss prevention, mailbox moves, and data indexing.</span></span>

### <a name="sharepointonlineonedriveforbusinessandteamsfiles-uses"></a><span data-ttu-id="48265-135">Использование файлов SharePoint Online, OneDrive для бизнеса и Teams</span><span class="sxs-lookup"><span data-stu-id="48265-135">SharePoint Online, OneDrive for Business, and Teams files uses</span></span>

<span data-ttu-id="48265-136">Для файлов SharePoint Online, OneDrive для бизнеса и Teams ключ доступности никогда не используется за пределами возможности восстановления, и клиенты должны явным образом сообщить корпорации Майкрософт о необходимости инициировать использование ключа доступности во время сценария восстановления.</span><span class="sxs-lookup"><span data-stu-id="48265-136">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is NEVER used outside of the recovery capability and customers must explicitly instruct Microsoft to initiate use of the availability key during a recovery scenario.</span></span> <span data-ttu-id="48265-137">Автоматизированные операции службы основываются только на ключах клиентов в Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="48265-137">Automated service operations solely rely on your Customer Keys in Azure Key vault.</span></span> <span data-ttu-id="48265-138">Для получения подробных сведений о том, как иерархия ключей работает для этих служб, посмотрите, [как SharePoint Online, OneDrive для бизнеса и файлы Teams используют ключ доступности](#how-sharepoint-online-onedrive-for-business-and-teams-files-use-the-availability-key).</span><span class="sxs-lookup"><span data-stu-id="48265-138">For in-depth information about how the key hierarchy works for these services, see [How SharePoint Online, OneDrive for Business, and Teams files use the availability key](#how-sharepoint-online-onedrive-for-business-and-teams-files-use-the-availability-key).</span></span>

## <a name="availability-key-security"></a><span data-ttu-id="48265-139">Безопасность ключей доступности</span><span class="sxs-lookup"><span data-stu-id="48265-139">Availability key security</span></span>

<span data-ttu-id="48265-140">Корпорация Майкрософт разделяет ответственность за защиту данных с помощью создания экземпляра ключа доступности и получения значительных мер для ее защиты.</span><span class="sxs-lookup"><span data-stu-id="48265-140">Microsoft shares the responsibility of data protection with you by instantiating the availability key and taking extensive measures to protect it.</span></span> <span data-ttu-id="48265-141">Корпорация Майкрософт не предоставляет клиентам прямой контроль над ключом доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-141">Microsoft does not expose direct control of the availability key to customers.</span></span> <span data-ttu-id="48265-142">Например, можно выполнить только сведение (поворот) ключей, которыми вы владеете в Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="48265-142">For example, you can only roll (rotate) the keys that you own in Azure Key Vault.</span></span> <span data-ttu-id="48265-143">Для получения дополнительных сведений ознакомьтесь [с разделом или поворачивайте ключ клиента или ключ доступности](customer-key-availability-key-roll.md).</span><span class="sxs-lookup"><span data-stu-id="48265-143">For more information, see [Roll or rotate a customer key or an availability key](customer-key-availability-key-roll.md).</span></span>

### <a name="availability-key-secret-stores"></a><span data-ttu-id="48265-144">Секретные хранилища ключей доступности</span><span class="sxs-lookup"><span data-stu-id="48265-144">Availability key secret stores</span></span>

<span data-ttu-id="48265-145">Майкрософт обеспечивает защиту ключей доступности в контролируемом доступе, внутренним хранилищах, таких как клиентский Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="48265-145">Microsoft protects availability keys in access-controlled, internal secret stores like the customer-facing Azure Key Vault.</span></span> <span data-ttu-id="48265-146">Мы реализуем элементы управления доступом, чтобы предотвратить прямой доступ администраторов Майкрософт к секреты, которые находятся в.</span><span class="sxs-lookup"><span data-stu-id="48265-146">We implement access controls to prevent Microsoft administrators from directly accessing the secrets contained within.</span></span> <span data-ttu-id="48265-147">Операции с конфиденциальным хранилищем, включая вращение ключей, удаление и извлечение, выполняются с помощью автоматических команд, которые никогда не задействуют прямой доступ к ключу доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-147">Secret Store operations, including key rotation, deletion, and retrieval occur through automated commands that never involve direct access to the availability key.</span></span> <span data-ttu-id="48265-148">Access для корректировки этих команд ограничены определенными инженерами и требуют эскалации прав через внутреннее средство, защищенное хранилище.</span><span class="sxs-lookup"><span data-stu-id="48265-148">Access to adjust these commands is limited to specific engineers and requires privilege escalation through an internal tool, Lockbox.</span></span> <span data-ttu-id="48265-149">Эскалация прав требует утверждения и обоснования руководителя перед предоставлением.</span><span class="sxs-lookup"><span data-stu-id="48265-149">Privilege escalation requires manager approval and justification prior to being granted.</span></span> <span data-ttu-id="48265-150">Защищенное хранилище обеспечивает ограниченный доступ к времени доступа с помощью автоматического отзыва доступа после истечения срока действия или завершения инженерного выхода.</span><span class="sxs-lookup"><span data-stu-id="48265-150">Lockbox ensures access is time bound with automatic access revocation upon time expiration or engineer log out.</span></span>

<span data-ttu-id="48265-151">Ключи доступности **Exchange Online и Skype для бизнеса** хранятся в секретном хранилище Active Directory.</span><span class="sxs-lookup"><span data-stu-id="48265-151">**Exchange Online and Skype for Business** availability keys are stored in an Active Directory secret store.</span></span> <span data-ttu-id="48265-152">Exchange Online Active Directory состоит из лесов управления, которые направляют трафик и леса емкости, содержащие объекты, удостоверения и данные.</span><span class="sxs-lookup"><span data-stu-id="48265-152">Exchange Online Active Directory is comprised of Management forests that route traffic and Capacity forests that contain objects, identities, and data.</span></span> <span data-ttu-id="48265-153">Леса емкости состоят из лесов учетных записей и лесов ресурсов.</span><span class="sxs-lookup"><span data-stu-id="48265-153">Capacity forests consist of Account forests and Resource forests.</span></span> <span data-ttu-id="48265-154">В лесах учетных записей имеется несколько контроллеров домена емкости, которые синхронизируются друг с другом.</span><span class="sxs-lookup"><span data-stu-id="48265-154">Account forests have multiple Capacity domain controllers that are synced with one another.</span></span> <span data-ttu-id="48265-155">Ключи доступности надежно хранятся на этих контроллерах домена.</span><span class="sxs-lookup"><span data-stu-id="48265-155">Availability keys are securely stored within these Capacity domain controllers.</span></span> <span data-ttu-id="48265-156">Это безопасное место хранения является отдельным и изолированным из облачного хранилища SharePoint Online, OneDrive для бизнеса и файлов Teams.</span><span class="sxs-lookup"><span data-stu-id="48265-156">This secure storage location is separate and isolated from the SharePoint Online, OneDrive for Business, and Teams files secret store.</span></span>

<span data-ttu-id="48265-157">Ключи доступности **файлов SharePoint Online, OneDrive для бизнеса и Teams** хранятся во внутреннем секретном хранилище, управляемом группой обслуживания.</span><span class="sxs-lookup"><span data-stu-id="48265-157">**SharePoint Online, OneDrive for Business, and Teams files** availability keys are stored in an internal secret store managed by the service team.</span></span> <span data-ttu-id="48265-158">Защищенная, Секретная служба хранения содержит серверы переднего плана с конечными точками приложений и базой данных SQL в качестве серверной части.</span><span class="sxs-lookup"><span data-stu-id="48265-158">This secured, secrets storage service has front-end servers with application endpoints and a SQL Database as the back end.</span></span> <span data-ttu-id="48265-159">Ключи доступности хранятся в базе данных SQL и упаковываются (шифруются) ключами шифрования банка, которые используют сочетание AES-256 и HMAC для шифрования ключа доступности в REST.</span><span class="sxs-lookup"><span data-stu-id="48265-159">Availability keys are stored in the SQL Database and are wrapped (encrypted) by secret store encryption keys that use a combination of AES-256 and HMAC to encrypt the availability key at rest.</span></span> <span data-ttu-id="48265-160">Ключи шифрования для секретного хранилища хранятся в логически изолированном компоненте той же базы данных SQL и дополнительно шифруются с помощью ключей RSA-2048, которые содержатся в сертификатах, управляемых центром сертификации (ЦС) Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="48265-160">The secret store encryption keys are stored in a logically isolated component of the same SQL Database and are further encrypted with RSA-2048 keys contained in certificates managed by the Microsoft certificate authority (CA).</span></span> <span data-ttu-id="48265-161">Эти сертификаты хранятся на серверах переднего плана банка, которые выполняют операции с базой данных.</span><span class="sxs-lookup"><span data-stu-id="48265-161">These certificates are stored in the secret store front-end servers that perform operations against the database.</span></span>

### <a name="defense-in-depth"></a><span data-ttu-id="48265-162">Глубокая защита</span><span class="sxs-lookup"><span data-stu-id="48265-162">Defense-in-depth</span></span>

<span data-ttu-id="48265-163">Корпорация Майкрософт использует стратегию защиты от несанкционированного доступа, чтобы предотвратить влияние вредоносных субъектов на конфиденциальность, целостность или доступность данных клиентов, хранящихся в облаке Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="48265-163">Microsoft employs a defense-in-depth strategy to prevent malicious actors from impacting the confidentiality, integrity, or availability of customer data stored in the Microsoft Cloud.</span></span> <span data-ttu-id="48265-164">Для защиты секретного хранилища и ключа доступности в рамках стратегии безопасности с перегрузкой применяются определенные профилактическые элементы управления и элементы управления обнаруживающее.</span><span class="sxs-lookup"><span data-stu-id="48265-164">Specific preventive and detective controls are implemented to protect the secret store and the availability key as part of the overarching security strategy.</span></span>

<span data-ttu-id="48265-165">Office 365 разработан для предотвращения неправильного использования ключа доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-165">Office 365 is built to prevent misuse of the availability key.</span></span> <span data-ttu-id="48265-166">Уровень приложений — единственный способ, с помощью которого можно шифровать и расшифровывать данные с помощью ключей, включая ключ доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-166">The application layer is the only method through which keys, including the availability key, can be used to encrypt and decrypt data.</span></span> <span data-ttu-id="48265-167">Только код службы Office 365 может интерпретировать и просматривать ключевую иерархию для действий шифрования и расшифровки.</span><span class="sxs-lookup"><span data-stu-id="48265-167">Only Office 365 service code has the ability to interpret and traverse the key hierarchy for encryption and decryption activities.</span></span> <span data-ttu-id="48265-168">Если вредоносному администратору корпорации Майкрософт пришлось обходить элементы управления для извлечения ключа доступности из секретного хранилища, ключ не будет использоваться для доступа к данным клиента.</span><span class="sxs-lookup"><span data-stu-id="48265-168">If a malicious Microsoft administrator were to circumvent controls to extract an availability key from the secret store, the key would be unusable to access customer data.</span></span> <span data-ttu-id="48265-169">Существует логическая изоляция между местами хранения ключей клиентов, ключей доступности, другими иерархическими ключами и данными клиентов.</span><span class="sxs-lookup"><span data-stu-id="48265-169">Logical isolation exists between the storage locations of Customer Keys, availability keys, other hierarchical keys, and customer data.</span></span> <span data-ttu-id="48265-170">Такая изоляция снижает риск риска потери данных в случае нарушения безопасности одного или нескольких расположений.</span><span class="sxs-lookup"><span data-stu-id="48265-170">This isolation mitigates the risk of data exposure in the event one or more locations are compromised.</span></span> <span data-ttu-id="48265-171">Каждый слой в иерархии содержит Круглосуточная возможность обнаружения вторжений для защиты данных и конфиденциальных хранилищ.</span><span class="sxs-lookup"><span data-stu-id="48265-171">Each layer in the hierarchy has built in 24x7 intrusion detection capabilities to protect data and secrets stores.</span></span>

<span data-ttu-id="48265-172">Элементы управления доступом реализуются для предотвращения несанкционированного доступа к внутренним системам, в том числе хранилищ секретных ключей доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-172">Access controls are implemented to prevent unauthorized access to internal systems, including availability key secret stores.</span></span> <span data-ttu-id="48265-173">У инженеров Майкрософт нет прямого доступа к секретным хранилищам ключей доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-173">Microsoft engineers don't have direct access to the availability key secret stores.</span></span> <span data-ttu-id="48265-174">Для получения дополнительных сведений об элементах управления доступом просмотрите [элементы управления административным доступом в Office 365](https://docs.microsoft.com/Office365/securitycompliance/office-365-administrative-access-controls-overview).</span><span class="sxs-lookup"><span data-stu-id="48265-174">For additional detail on access controls, review [Administrative Access Controls in Office 365](https://docs.microsoft.com/Office365/securitycompliance/office-365-administrative-access-controls-overview).</span></span>

<span data-ttu-id="48265-175">Технические элементы управления предотвращают вход сотрудников Майкрософт в учетные записи с повышенными привилегиями, которые могут быть использованы злоумышленниками для олицетворения служб Office 365.</span><span class="sxs-lookup"><span data-stu-id="48265-175">Technical controls prevent Microsoft personnel from logging into highly-privileged service accounts, which might otherwise be used by attackers to impersonate Office 365 services.</span></span> <span data-ttu-id="48265-176">Например, эти элементы управления запрещают интерактивный вход.</span><span class="sxs-lookup"><span data-stu-id="48265-176">For example, these controls prevent interactive logon.</span></span>

<span data-ttu-id="48265-177">Элементы управления ведения журнала и мониторинга безопасности — это еще одна глубокая защита, которая позволяет снизить риск для служб Майкрософт и данных.</span><span class="sxs-lookup"><span data-stu-id="48265-177">Security logging and monitoring controls are another defense-in-depth safeguard implemented that mitigate risk to Microsoft services and your data.</span></span> <span data-ttu-id="48265-178">Microsoft Service Teams развернула активные решения мониторинга, которые создают оповещения и журналы аудита.</span><span class="sxs-lookup"><span data-stu-id="48265-178">Microsoft service teams have deployed active monitoring solutions that generate alerts and audit logs.</span></span> <span data-ttu-id="48265-179">Все сервисные группы отправляют свои журналы в центральный репозиторий, в котором журналы объединяются и обрабатываются.</span><span class="sxs-lookup"><span data-stu-id="48265-179">All service teams upload their logs to a central repository where the logs are aggregated and processed.</span></span> <span data-ttu-id="48265-180">Внутренние средства автоматически проверяют записи, чтобы убедиться, что службы работают в оптимальном, надежном и безопасном состоянии.</span><span class="sxs-lookup"><span data-stu-id="48265-180">Internal tools automatically examine records to confirm that services are functioning in an optimal, resilient, and secure state.</span></span> <span data-ttu-id="48265-181">Необычные действия помечаются для дальнейшей проверки.</span><span class="sxs-lookup"><span data-stu-id="48265-181">Unusual activity is flagged for further review.</span></span>

<span data-ttu-id="48265-182">Любое событие в журнале, которое указывает на потенциальное нарушение политики безопасности Майкрософт, немедленно передается на интересующие вас команды Microsoft Security Teams.</span><span class="sxs-lookup"><span data-stu-id="48265-182">Any log event that indicates a potential violation of the Microsoft Security Policy is immediately brought to the attention of Microsoft security teams.</span></span> <span data-ttu-id="48265-183">Система безопасности Office 365 настроила оповещения для обнаружения попытки доступа к секретным хранилищам ключей доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-183">Office 365 security has configured alerts to detect attempted access to availability key secret stores.</span></span> <span data-ttu-id="48265-184">Кроме того, оповещения создаются, если сотрудники Майкрософт пытаются интерактивно войти в учетные записи служб, что запрещено и защищено средствами управления доступом.</span><span class="sxs-lookup"><span data-stu-id="48265-184">Alerts are also generated if Microsoft personnel attempt interactive logon to service accounts, which is prohibited and protected by access controls.</span></span> <span data-ttu-id="48265-185">Система безопасности Office 365 также обнаруживает и оповещает об отклонениях службы Office 365 от обычных базовых операций.</span><span class="sxs-lookup"><span data-stu-id="48265-185">Office 365 security also detects and alerts upon deviations of the Office 365 service from normal baseline operations.</span></span> <span data-ttu-id="48265-186">Малефакторс попытка использования неправильного использования служб Office 365 вызовет предупреждения, которые приводят к вытеснению нежелательной стороны из облачной среды Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="48265-186">Malefactors attempting to misuse Office 365 services would trigger alerts resulting in the offender's eviction from the Microsoft cloud environment.</span></span>

## <a name="use-the-availability-key-to-recover-from-key-loss"></a><span data-ttu-id="48265-187">Использование ключа доступности для восстановления после потери ключа</span><span class="sxs-lookup"><span data-stu-id="48265-187">Use the availability key to recover from key loss</span></span>

<span data-ttu-id="48265-188">Если вы потеряли возможности управления ключами клиентов, ключ доступности позволяет восстановить и повторно зашифровать данные.</span><span class="sxs-lookup"><span data-stu-id="48265-188">If you lose control of your Customer Keys, the availability key provides you the ability to recover and re-encrypt your data.</span></span>

### <a name="recovery-procedure-for-exchange-online-and-skype-for-business"></a><span data-ttu-id="48265-189">Процедура восстановления для Exchange Online и Skype для бизнеса</span><span class="sxs-lookup"><span data-stu-id="48265-189">Recovery procedure for Exchange Online and Skype for Business</span></span>

<span data-ttu-id="48265-190">Если вы потеряете контроль над ключами клиентов, ключ доступности позволяет восстановить данные и вернуть затронутые ресурсы Office 365 в оперативный режим.</span><span class="sxs-lookup"><span data-stu-id="48265-190">If you lose control of your Customer Keys, the availability key gives you the capability to recover your data and bring your impacted Office 365 resources back online.</span></span> <span data-ttu-id="48265-191">Ключ доступности продолжает защищать ваши данные при восстановлении. На высоком уровне, чтобы полностью восстановиться после потери ключа, вам потребуется создать новую функцию DEP и переместить затронутые ресурсы в новую политику.</span><span class="sxs-lookup"><span data-stu-id="48265-191">The availability key continues to protect your data while you recover.At a high level, to fully recover from key loss, you'll need to create a new DEP and move impacted resources to the new policy.</span></span>

<span data-ttu-id="48265-192">Чтобы зашифровать данные с помощью новых ключей клиентов, создайте новые ключи в Azure Key Vault, создайте новую функцию DEP с помощью новых ключей клиентов, а затем назначьте новую функцию DEP почтовым ящикам, которые в настоящее время зашифрованы с помощью функции DEP, для которых были утрачены или скомпрометированы ключи.</span><span class="sxs-lookup"><span data-stu-id="48265-192">To encrypt your data with new Customer Keys, create new keys in Azure Key Vault, create a new DEP using the new Customer Keys, then assign the new DEP to the mailboxes currently encrypted with the previous DEP for which the keys were lost or compromised.</span></span>

<span data-ttu-id="48265-193">Этот процесс повторного шифрования может занять до 72 часов.</span><span class="sxs-lookup"><span data-stu-id="48265-193">This re-encryption process can take up to 72 hours.</span></span> <span data-ttu-id="48265-194">Это стандартная длительность изменения функции DEP.</span><span class="sxs-lookup"><span data-stu-id="48265-194">This is the standard duration when you change a DEP.</span></span>
  
### <a name="recovery-procedure-for-sharepointonlineonedriveforbusinessandteamsfiles"></a><span data-ttu-id="48265-195">Процедура восстановления для файлов SharePoint Online, OneDrive для бизнеса и Teams</span><span class="sxs-lookup"><span data-stu-id="48265-195">Recovery procedure for SharePoint Online, OneDrive for Business, and Teams files</span></span>

<span data-ttu-id="48265-196">Для SharePoint Online, OneDrive для бизнеса и файлов Teams ключ доступности никогда не используется за пределами возможности восстановления.</span><span class="sxs-lookup"><span data-stu-id="48265-196">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is NEVER used outside of the recovery capability.</span></span> <span data-ttu-id="48265-197">Необходимо явным образом сообщить корпорации Майкрософт о необходимости инициировать использование ключа доступности во время сценария восстановления.</span><span class="sxs-lookup"><span data-stu-id="48265-197">You must explicitly instruct Microsoft to initiate use of the availability key during a recovery scenario.</span></span> <span data-ttu-id="48265-198">Чтобы начать процесс восстановления, обратитесь в корпорацию Майкрософт, чтобы активировать ключ доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-198">To initiate the recovery process, contact Microsoft to activate the availability key.</span></span> <span data-ttu-id="48265-199">После активации ключ доступности автоматически используется для расшифровки данных с возможностью шифрования данных с помощью вновь созданной функции DEP, связанной с новыми ключами клиентов.</span><span class="sxs-lookup"><span data-stu-id="48265-199">Once activated, the availability key is automatically used to decrypt your data allowing you to encrypt the data with a newly-created DEP associated to new Customer Keys.</span></span>  

<span data-ttu-id="48265-200">Эта операция пропорциональна количеству сайтов в Организации.</span><span class="sxs-lookup"><span data-stu-id="48265-200">This operation is proportional to the number of sites in your organization.</span></span> <span data-ttu-id="48265-201">Когда вы звоните в корпорацию Майкрософт, чтобы использовать ключ доступности, вы должны быть полностью подключены примерно в течение четырех часов.</span><span class="sxs-lookup"><span data-stu-id="48265-201">Once you call Microsoft to use the availability key, you should be fully online within about four hours.</span></span>

## <a name="how-exchange-online-and-skype-for-business-use-the-availability-key"></a><span data-ttu-id="48265-202">Использование ключа доступности в Exchange Online и Skype для бизнеса</span><span class="sxs-lookup"><span data-stu-id="48265-202">How Exchange Online and Skype for Business use the availability key</span></span>

<span data-ttu-id="48265-203">При создании функции DEP с помощью ключа клиента Office 365 создает ключ политики шифрования данных (ключ DEP), связанный с этой функцией предотвращения выполнения данных.</span><span class="sxs-lookup"><span data-stu-id="48265-203">When you create a DEP with Customer Key, Office 365 generates a Data Encryption Policy Key (DEP Key) associated with that DEP.</span></span> <span data-ttu-id="48265-204">Служба шифрует ключ DEP три раза: один раз с каждым из ключей клиента и один раз с ключом доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-204">The service encrypts the DEP Key three times: once with each of the customer keys and once with the availability key.</span></span> <span data-ttu-id="48265-205">Хранятся только зашифрованные версии ключа DEP, а ключ DEP можно расшифровать только с помощью ключей клиента или доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-205">Only the encrypted versions of the DEP Key are stored, and a DEP Key can only be decrypted with the customer keys or the availability key.</span></span> <span data-ttu-id="48265-206">Затем ключ DEP используется для шифрования ключей почтовых ящиков, которые шифруют отдельные почтовые ящики.</span><span class="sxs-lookup"><span data-stu-id="48265-206">The DEP Key is then used to encrypt Mailbox Keys, which encrypt individual mailboxes.</span></span>
  
<span data-ttu-id="48265-207">В Office 365 эта процедура используется для расшифровки и предоставления данных, когда клиенты используют службу:</span><span class="sxs-lookup"><span data-stu-id="48265-207">Office 365 follows this process to decrypt and provide data when customers are using the service:</span></span>
  
1. <span data-ttu-id="48265-208">Расшифровать ключ DEP с помощью ключа клиента.</span><span class="sxs-lookup"><span data-stu-id="48265-208">Decrypt the DEP Key using the Customer Key.</span></span>

2. <span data-ttu-id="48265-209">Используйте расшифрованную клавишу DEP для расшифровки ключа почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="48265-209">Use the decrypted DEP Key to decrypt a Mailbox Key.</span></span>

3. <span data-ttu-id="48265-210">Используйте расшифрованный ключ для почтового ящика, чтобы расшифровать сам почтовый ящик, позволяя получить доступ к данным в почтовом ящике.</span><span class="sxs-lookup"><span data-stu-id="48265-210">Use the decrypted Mailbox Key to decrypt the mailbox itself, allowing you to access the data within the mailbox.</span></span>

<span data-ttu-id="48265-211">Office 365 расшифровывает ключ DEP, выполнив два запроса расшифровки в Azure Key Vault с небольшим смещением.</span><span class="sxs-lookup"><span data-stu-id="48265-211">Office 365 decrypts a DEP Key by issuing two decryption requests to Azure Key Vault with a slight offset.</span></span> <span data-ttu-id="48265-212">Первый из них, для которого завершается результат, отменяющий другой запрос.</span><span class="sxs-lookup"><span data-stu-id="48265-212">The first one to finish furnishes the result, canceling the other request.</span></span>

## <a name="how-sharepoint-online-onedrive-for-business-and-teams-files-use-the-availability-key"></a><span data-ttu-id="48265-213">Как SharePoint Online, OneDrive для бизнеса и файлы Teams используют ключ доступности</span><span class="sxs-lookup"><span data-stu-id="48265-213">How SharePoint Online, OneDrive for Business, and Teams files use the availability key</span></span>

<span data-ttu-id="48265-214">Архитектура SharePoint Online и OneDrive для бизнеса и реализация ключа клиента и ключа доступности отличаются от Exchange Online и Skype для бизнеса.</span><span class="sxs-lookup"><span data-stu-id="48265-214">The SharePoint Online and OneDrive for Business architecture and implementation for Customer Key and availability key are different from Exchange Online and Skype for Business.</span></span>
  
<span data-ttu-id="48265-215">Когда Организация перемещается на управляемые пользователем ключи, Office 365 создает промежуточный ключ, зависящий от клиента (тик).</span><span class="sxs-lookup"><span data-stu-id="48265-215">When an organization moves to customer-managed keys, Office 365 creates a tenant-specific intermediate key (TIK).</span></span> <span data-ttu-id="48265-216">Office 365 шифрует тик дважды, один раз с каждым из ключей клиента и сохраняет две зашифрованные версии тик.</span><span class="sxs-lookup"><span data-stu-id="48265-216">Office 365 encrypts the TIK twice, once with each of the customer keys, and stores the two encrypted versions of the TIK.</span></span> <span data-ttu-id="48265-217">Хранятся только зашифрованные версии тик, и тик можно расшифровать только с помощью ключей клиентов.</span><span class="sxs-lookup"><span data-stu-id="48265-217">Only the encrypted versions of the TIK are stored, and a TIK can only be decrypted with the customer keys.</span></span> <span data-ttu-id="48265-218">Затем Тик используется для шифрования ключей сайта, которые затем используются для шифрования ключей больших двоичных объектов (также называемых ключами фрагментов файлов).</span><span class="sxs-lookup"><span data-stu-id="48265-218">The TIK is then used to encrypt site keys, which are then used to encrypt blob keys (also called file chunk keys).</span></span> <span data-ttu-id="48265-219">В зависимости от размера файла служба может разделить файл на несколько фрагментов файлов с уникальным ключом.</span><span class="sxs-lookup"><span data-stu-id="48265-219">Depending on file size, the service may split a file into multiple file chunks each with a unique key.</span></span> <span data-ttu-id="48265-220">Сами большие двоичные объекты (блоки файлов) шифруются с помощью ключей больших двоичных объектов и хранятся в службе хранилища больших двоичных объектов Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="48265-220">The blobs (file chunks) themselves are encrypted with the blob keys and stored in the Microsoft Azure Blob storage service.</span></span>
  
<span data-ttu-id="48265-221">Office 365 выполняет следующие действия для расшифровки и предоставления файлов клиентов при использовании службы клиентами:</span><span class="sxs-lookup"><span data-stu-id="48265-221">Office 365 follows this process to decrypt and provide customer files when customers are using the service:</span></span>

1. <span data-ttu-id="48265-222">Расшифровать тик с помощью ключа клиента.</span><span class="sxs-lookup"><span data-stu-id="48265-222">Decrypt the TIK using the Customer Key.</span></span>

2. <span data-ttu-id="48265-223">Используйте расшифрованную тик для расшифровки ключа сайта.</span><span class="sxs-lookup"><span data-stu-id="48265-223">Use the decrypted TIK to decrypt a site key.</span></span>

3. <span data-ttu-id="48265-224">Используйте расшифрованный ключ сайта для расшифровки ключа большого двоичного объекта.</span><span class="sxs-lookup"><span data-stu-id="48265-224">Use the decrypted site key to decrypt a blob key.</span></span>

4. <span data-ttu-id="48265-225">Используйте расшифрованный ключ BLOB, чтобы расшифровать большой двоичный объект.</span><span class="sxs-lookup"><span data-stu-id="48265-225">Use the decrypted blob key to decrypt the blob.</span></span>

<span data-ttu-id="48265-226">Office 365 расшифровывает тик, выдавая два запроса на расшифровку в хранилище ключей Azure с небольшим смещением.</span><span class="sxs-lookup"><span data-stu-id="48265-226">Office 365 decrypts a TIK by issuing two decryption requests to Azure Key Vault with a slight offset.</span></span> <span data-ttu-id="48265-227">Первый из них, для которого завершается результат, отменяющий другой запрос.</span><span class="sxs-lookup"><span data-stu-id="48265-227">The first one to finish furnishes the result, canceling the other request.</span></span>
  
<span data-ttu-id="48265-228">Если вы потеряли доступ к ключам клиента, Office 365 также шифрует тик с помощью ключа доступности и сохраняет его вместе с ТИКС, зашифрованным с каждым ключом клиента.</span><span class="sxs-lookup"><span data-stu-id="48265-228">In case you lose access to your customer keys, Office 365 also encrypts the TIK with an availability key and stores this along with the TIKs encrypted with each customer key.</span></span> <span data-ttu-id="48265-229">Тик, зашифрованный с помощью ключа доступности, используется только в том случае, если клиент обращается в корпорацию Майкрософт, чтобы прикрепить путь восстановления, когда он потеряет доступ к их ключам, злонамеренно или случайно.</span><span class="sxs-lookup"><span data-stu-id="48265-229">The TIK encrypted with the availability key is used only when the customer calls Microsoft to enlist the recovery path when they have lost access to their keys, maliciously or accidentally.</span></span>
  
<span data-ttu-id="48265-230">В целях обеспечения доступности и масштабирования расшифрованные ТИКС кэшируются в кэше памяти с ограниченным временем.</span><span class="sxs-lookup"><span data-stu-id="48265-230">For availability and scale reasons, decrypted TIKs are cached in a time-limited memory cache.</span></span> <span data-ttu-id="48265-231">На два часа до истечения срока действия кэша тик Office 365 пытается расшифровать каждую тик.</span><span class="sxs-lookup"><span data-stu-id="48265-231">Two hours before a TIK cache is set to expire, Office 365 attempts to decrypt each TIK.</span></span> <span data-ttu-id="48265-232">Расшифровка ТИКС увеличивает время существования кэша.</span><span class="sxs-lookup"><span data-stu-id="48265-232">Decrypting the TIKs extends the lifetime of the cache.</span></span> <span data-ttu-id="48265-233">Если не удается выполнить расшифровку тик в течение значительного периода времени, Office 365 создает оповещение о проектировании до истечения срока действия кэша.</span><span class="sxs-lookup"><span data-stu-id="48265-233">If TIK decryption fails for a significant amount of time, Office 365 generates an alert to notify engineering prior to the cache expiration.</span></span> <span data-ttu-id="48265-234">Только если клиент звонит в корпорацию Майкрософт, Office 365 инициирует операцию восстановления, которая включает в себя расшифровку тик с помощью ключа доступности, хранящегося в секретном банке Майкрософт, и повторное подключение клиента с помощью расшифрованного тик и нового набора ключи Azure Key Vault, предоставленные пользователем.</span><span class="sxs-lookup"><span data-stu-id="48265-234">Only if the customer calls Microsoft will Office 365 initiate the recovery operation, which involves decrypting the TIK with the availability key stored in Microsoft's secret store and onboarding the tenant again using the decrypted TIK and a new set of customer-supplied Azure Key Vault keys.</span></span>
  
<span data-ttu-id="48265-235">На сегодняшний день ключ клиента участвует в цепочке шифрования и расшифровки данных файлов SharePoint Online, хранящихся в хранилище больших двоичных объектов Azure, но не в SharePoint Online элементы списка или метаданные, хранящиеся в базе данных SQL.</span><span class="sxs-lookup"><span data-stu-id="48265-235">As of today, Customer Key is involved in the encryption and decryption chain of SharePoint Online file data stored in the Azure blob store, but not SharePoint Online list items or metadata stored in the SQL Database.</span></span> <span data-ttu-id="48265-236">В Office 365 не используется ключ доступности для Exchange Online, Skype для бизнеса, SharePoint Online, OneDrive для бизнеса и файлов Teams, кроме описанного выше варианта, который инициируется клиентом.</span><span class="sxs-lookup"><span data-stu-id="48265-236">Office 365 does not use the availability key for Exchange Online, Skype for Business, SharePoint Online, OneDrive for Business, and Teams files other than the case described above, which is customer-initiated.</span></span> <span data-ttu-id="48265-237">Доступ людей к данным клиентов защищается с помощью защищенного хранилища клиента.</span><span class="sxs-lookup"><span data-stu-id="48265-237">Human access to customer data is protected by Customer Lockbox.</span></span>

## <a name="availability-key-triggers"></a><span data-ttu-id="48265-238">Триггеры ключей доступности</span><span class="sxs-lookup"><span data-stu-id="48265-238">Availability key triggers</span></span>

<span data-ttu-id="48265-239">Office 365 активирует ключ доступности только в определенных обстоятельствах.</span><span class="sxs-lookup"><span data-stu-id="48265-239">Office 365 triggers the availability key only in specific circumstances.</span></span> <span data-ttu-id="48265-240">Эти обстоятельства отличаются службой.</span><span class="sxs-lookup"><span data-stu-id="48265-240">These circumstances differ by service.</span></span>

### <a name="triggers-for-exchange-online-and-skype-for-business"></a><span data-ttu-id="48265-241">Триггеры для Exchange Online и Skype для бизнеса</span><span class="sxs-lookup"><span data-stu-id="48265-241">Triggers for Exchange Online and Skype for Business</span></span>
  
1. <span data-ttu-id="48265-242">Office 365 считывает компонент DEP, к которому назначен почтовый ящик, чтобы определить расположение двух ключей клиентов в Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="48265-242">Office 365 reads the DEP to which the mailbox is assigned in order to determine the location of the two Customer Keys in Azure Key Vault.</span></span>

2. <span data-ttu-id="48265-243">Office 365 случайным образом выбирает один из двух ключей клиентов из DEP и отправляет запрос в Azure Key Vault для распаковки ключа DEP с помощью ключа клиента.</span><span class="sxs-lookup"><span data-stu-id="48265-243">Office 365 randomly chooses one of the two Customer Keys from the DEP and sends a request to Azure Key Vault to unwrap the DEP key using the Customer Key.</span></span>

3. <span data-ttu-id="48265-244">Если запрос на распаковку ключа DEP с помощью ключа клиента завершается с ошибкой, Office 365 отправляет второй запрос в Azure Key Vault, на этот раз предписывает ему использовать альтернативный (второй) ключ клиента.</span><span class="sxs-lookup"><span data-stu-id="48265-244">If the request to unwrap the DEP key using the Customer Key fails, Office 365 sends a second request to Azure Key Vault, this time instructing it to use the alternate (second) Customer Key.</span></span>

4. <span data-ttu-id="48265-245">Если второй запрос для распаковки ключа DEP с помощью ключа клиента завершается сбоем, Office 365 проверяет результаты обоих запросов.</span><span class="sxs-lookup"><span data-stu-id="48265-245">If the second request to unwrap the DEP key using the Customer Key fails, Office 365 examines the results of both requests.</span></span>

    - <span data-ttu-id="48265-246">Если исследование определяет, что запросы не удалось возвращать системную ошибку:</span><span class="sxs-lookup"><span data-stu-id="48265-246">If the examination determines that the requests failed returning a system ERROR:</span></span>

       - <span data-ttu-id="48265-247">Office 365 запускает ключ доступности для расшифровки ключа DEP.</span><span class="sxs-lookup"><span data-stu-id="48265-247">Office 365 triggers the availability key to decrypt the DEP key.</span></span>

       - <span data-ttu-id="48265-248">После этого Office 365 использует ключ DEP для расшифровки ключа почтового ящика и выполнения запроса пользователя.</span><span class="sxs-lookup"><span data-stu-id="48265-248">Office 365 then uses the DEP key to decrypt the mailbox key and complete the user request.</span></span> 

       - <span data-ttu-id="48265-249">В этом случае Azure Key Vault либо не может ответить, либо недостижим из-за временной ошибки.</span><span class="sxs-lookup"><span data-stu-id="48265-249">In this case, Azure Key Vault is either unable to respond or unreachable due to a transient ERROR.</span></span>

    - <span data-ttu-id="48265-250">Если исследование определяет, что запросы с ошибками доступа не возвращаются:</span><span class="sxs-lookup"><span data-stu-id="48265-250">If the examination determines that the requests failed returning ACCESS DENIED:</span></span>

       - <span data-ttu-id="48265-251">Это означает, что вы предприняли намеренное, непреднамеренное или вредоносное действие для отображения ключей клиентов, которые недоступны (например, во время очистки данных в процессе выхода из службы).</span><span class="sxs-lookup"><span data-stu-id="48265-251">This means deliberate, inadvertent, or malicious action has been taken to render the customer keys unavailable (for example, during the data purge process as part of leaving the service).</span></span>

       - <span data-ttu-id="48265-252">В этом случае ключ доступности не будет использоваться, запрос пользователя завершится с ошибкой и пользователь получит сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="48265-252">In this case, the availability key will not be used, the user request fails, and the user receives an error message.</span></span>

>[!IMPORTANT]
><span data-ttu-id="48265-253">Код службы Office 365 всегда имеет действительный маркер имени входа для получения информации о клиентах, чтобы предоставить облачные службы для получения значений.</span><span class="sxs-lookup"><span data-stu-id="48265-253">Office 365 service code always has a valid login token for reasoning over customer data to provide value-adding cloud services.</span></span> <span data-ttu-id="48265-254">Таким образом, пока ключ доступности не будет удален, его можно использовать в качестве резервного для действий, инициированных или внутренних для Exchange Online и Skype для бизнеса, таких как создание индекса поиска или перемещение почтовых ящиков.</span><span class="sxs-lookup"><span data-stu-id="48265-254">Therefore, until the availability key has been deleted, it can be used as a fallback for actions initiated by, or internal to, Exchange Online and Skype for Business such as search index creation or moving mailboxes.</span></span> <span data-ttu-id="48265-255">Это относится как к временным ОШИБКАм, так и к запросам ОТКАЗа в ДОСТУПе к Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="48265-255">This applies to both transient ERRORS and ACCESS DENIED requests to Azure Key Vault.</span></span>

### <a name="triggers-for-sharepoint-online-onedrive-for-business-and-teams-files"></a><span data-ttu-id="48265-256">Триггеры для файлов SharePoint Online, OneDrive для бизнеса и Teams</span><span class="sxs-lookup"><span data-stu-id="48265-256">Triggers for SharePoint Online, OneDrive for Business, and Teams files</span></span>

<span data-ttu-id="48265-257">Для файлов SharePoint Online, OneDrive для бизнеса и Teams ключ доступности никогда не используется за пределами возможности восстановления, и клиенты должны явным образом сообщить корпорации Майкрософт о необходимости инициировать использование ключа доступности во время сценария восстановления.</span><span class="sxs-lookup"><span data-stu-id="48265-257">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is NEVER used outside of the recovery capability and customers must explicitly instruct Microsoft to initiate use of the availability key during a recovery scenario.</span></span>

## <a name="audit-logs-and-the-availability-key"></a><span data-ttu-id="48265-258">Журналы аудита и ключ доступности</span><span class="sxs-lookup"><span data-stu-id="48265-258">Audit logs and the availability key</span></span>

<span data-ttu-id="48265-259">Автоматизированные системы в Office 365 обрабатывают все данные, которые передаются через систему для предоставления облачных служб, например, защита от вирусов, обнаружения вирусов, защиты от потери данных и индексирования данных.</span><span class="sxs-lookup"><span data-stu-id="48265-259">Automated systems in Office 365 process all data as it flows through the system to provide cloud services, for example, anti-virus, e-discovery, data loss prevention, and data indexing.</span></span> <span data-ttu-id="48265-260">В Office 365 не создаются видимые для клиентов журналы для этого действия.</span><span class="sxs-lookup"><span data-stu-id="48265-260">Office 365 does not generate customer-visible logs for this activity.</span></span> <span data-ttu-id="48265-261">Кроме того, сотрудники Майкрософт не получают доступ к данным в рамках этих обычных системных операций.</span><span class="sxs-lookup"><span data-stu-id="48265-261">In addition, Microsoft personnel do not access your data as part of these normal system operations.</span></span>

### <a name="exchange-online-and-skype-for-business-availability-key-logging"></a><span data-ttu-id="48265-262">Ведение журнала ключей доступности в Exchange Online и Skype для бизнеса</span><span class="sxs-lookup"><span data-stu-id="48265-262">Exchange Online and Skype for Business availability key logging</span></span>

<span data-ttu-id="48265-263">Exchange Online и Skype для бизнеса автоматически используют ключ доступности во время временных ошибок.</span><span class="sxs-lookup"><span data-stu-id="48265-263">Exchange Online and Skype for Business automatically use the availability key during transient errors.</span></span> <span data-ttu-id="48265-264">В этом случае Office 365 публикует доступные для клиентов журналы из центра безопасности и соответствия требованиям.</span><span class="sxs-lookup"><span data-stu-id="48265-264">When this fallback occurs, Office 365 publishes customer-visible logs accessible from the Security and Compliance Center.</span></span> <span data-ttu-id="48265-265">Запись журнала аудита для операции с ключом доступности создается каждый раз, когда эти службы используют ключ доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-265">An audit log record for the availability key operation is generated each time these services use the availability key.</span></span> <span data-ttu-id="48265-266">Новый тип записи с именем "шифрование службы ключа клиента" с типом действия "резервное значение для ключа доступности" позволяет администраторам фильтровать результаты поиска по [единому журналу аудита](https://docs.microsoft.com/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance) для просмотра записей ключей доступности.</span><span class="sxs-lookup"><span data-stu-id="48265-266">A new record type called “Customer Key Service Encryption” with activity type "Fallback to Availability Key" allows admins to filter [Unified Audit Log](https://docs.microsoft.com/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance) search results to view availability key records.</span></span> <span data-ttu-id="48265-267">Запись ключа доступности создается только в том случае, если ключ клиента используется для доступа к данным, а не к ключам, управляемым службой Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="48265-267">The availability key record gets generated only when Customer Key is used to access the data and not for Microsoft service-managed keys.</span></span>

<span data-ttu-id="48265-268">Записи журнала включают такие атрибуты, как дата, время, действия, идентификатор организации и идентификатор политики шифрования данных.</span><span class="sxs-lookup"><span data-stu-id="48265-268">Log records include attributes such as date, time, activity, organization ID, and data encryption policy ID.</span></span> <span data-ttu-id="48265-269">Запись доступна в составе журналов единого аудита Office 365 и доступна на вкладке поиска в журнале безопасности центра безопасности и соответствия требованиям Office 365.</span><span class="sxs-lookup"><span data-stu-id="48265-269">The record is available as part of Office 365 Unified Audit Logs and is accessible from the Office 365 Security and Compliance Center Audit Log Search tab.</span></span>

![Поиск событий ключа доступности в журнале аудита](../media/customerkeyauditlogsearchavailabilitykeyloggingimage.png)

<span data-ttu-id="48265-271">Записи ключей доступности для Exchange Online и Skype для бизнеса используют [общую схему](https://docs.microsoft.com/office/office-365-management-api/office-365-management-activity-api-schema#common-schema) действий управления Office 365 с добавленными пользовательскими параметрами: идентификатор политики, идентификатор версии ключа области и идентификатор запроса.</span><span class="sxs-lookup"><span data-stu-id="48265-271">Exchange Online and Skype for Business availability key records use the Office 365 Management Activity [common schema](https://docs.microsoft.com/office/office-365-management-api/office-365-management-activity-api-schema#common-schema) with added custom parameters: Policy Id, Scope Key Version Id, and Request Id.</span></span>

![Настраиваемые параметры ключа доступности](../media/customerkeyauditlogsearchavailabilitykeyloggingcustomparam.png)

### <a name="sharepoint-online-onedrive-for-business-and-teams-files-availability-key-logging"></a><span data-ttu-id="48265-273">Ведение журнала ключей доступности для SharePoint Online, OneDrive для бизнеса и файлов Teams</span><span class="sxs-lookup"><span data-stu-id="48265-273">SharePoint Online, OneDrive for Business, and Teams files availability key logging</span></span>

<span data-ttu-id="48265-274">Ведение журнала ключа доступности для этих служб пока недоступно.</span><span class="sxs-lookup"><span data-stu-id="48265-274">Availability key logging isn't available yet for these services.</span></span> <span data-ttu-id="48265-275">Для SharePoint Online, OneDrive для бизнеса и файлов Teams ключ доступности активируется только корпорацией Майкрософт, когда вы указали его в целях восстановления.</span><span class="sxs-lookup"><span data-stu-id="48265-275">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is only activated by Microsoft, when instructed by you, for recovery purposes.</span></span> <span data-ttu-id="48265-276">В результате вы уже знаете каждое событие, в котором ключ доступности используется для этих служб.</span><span class="sxs-lookup"><span data-stu-id="48265-276">As a result, you already know every event in which the availability key is used for these services.</span></span>

## <a name="availability-key-in-the-customer-key-hierarchy"></a><span data-ttu-id="48265-277">Ключ доступности в иерархии ключей клиентов</span><span class="sxs-lookup"><span data-stu-id="48265-277">Availability key in the Customer Key hierarchy</span></span>
  
<span data-ttu-id="48265-278">Office 365 использует ключ доступности, чтобы заключить уровень ключей в нижнюю иерархию ключей, установленную для шифрования службы клиентских ключей.</span><span class="sxs-lookup"><span data-stu-id="48265-278">Office 365 uses the availability key to wrap the tier of keys lower in the key hierarchy established for Customer Key service encryption.</span></span> <span data-ttu-id="48265-279">Между службами существует несколько ключевых иерархий.</span><span class="sxs-lookup"><span data-stu-id="48265-279">Different key hierarchies exist between services.</span></span> <span data-ttu-id="48265-280">Ключевые алгоритмы также отличаются между ключами доступности и другими ключами в иерархии каждой соответствующей службы.</span><span class="sxs-lookup"><span data-stu-id="48265-280">Key algorithms also differ between availability keys and other keys in the hierarchy of each applicable service.</span></span> <span data-ttu-id="48265-281">Ниже приведены алгоритмы использования ключей доступности, используемые различными службами.</span><span class="sxs-lookup"><span data-stu-id="48265-281">The availability key algorithms used by the different services are as follows:</span></span>

- <span data-ttu-id="48265-282">Ключи доступности Exchange Online и Skype для бизнеса используют AES-256.</span><span class="sxs-lookup"><span data-stu-id="48265-282">The Exchange Online and Skype for Business availability keys use AES-256.</span></span>

- <span data-ttu-id="48265-283">Ключи доступности файлов SharePoint Online, OneDrive для бизнеса и Teams используют RSA-2048.</span><span class="sxs-lookup"><span data-stu-id="48265-283">The SharePoint Online, OneDrive for Business, and Teams files availability keys use RSA-2048.</span></span>

### <a name="encryption-ciphers-used-to-encrypt-keys-for-exchange-online-and-skype-for-business"></a><span data-ttu-id="48265-284">Шифры шифрования, используемые для шифрования ключей в Exchange Online и Skype для бизнеса</span><span class="sxs-lookup"><span data-stu-id="48265-284">Encryption ciphers used to encrypt keys for Exchange Online and Skype for Business</span></span>

![Шифры шифрования для ключа клиента Exchange Online](../media/customerkeyencryptionhierarchiesexchangeskype.png)

### <a name="encryption-ciphers-used-to-encrypt-keys-for-sharepoint-online-and-onedrive-for-business"></a><span data-ttu-id="48265-286">Шифры шифрования, используемые для шифрования ключей для SharePoint Online и OneDrive для бизнеса</span><span class="sxs-lookup"><span data-stu-id="48265-286">Encryption ciphers used to encrypt keys for SharePoint Online and OneDrive for Business</span></span>

![Шифры шифрования для ключа клиента SharePoint Online](../media/customerkeyencryptionhierarchiessharepointonedriveteamsfiles.png)

## <a name="related-articles"></a><span data-ttu-id="48265-288">Статьи по теме</span><span class="sxs-lookup"><span data-stu-id="48265-288">Related articles</span></span>

- [<span data-ttu-id="48265-289">Шифрование службы с помощью ключа клиента для Office 365</span><span class="sxs-lookup"><span data-stu-id="48265-289">Service encryption with Customer Key for Office 365</span></span>](customer-key-overview.md)

- [<span data-ttu-id="48265-290">Настройка ключа клиента для Office 365</span><span class="sxs-lookup"><span data-stu-id="48265-290">Set up Customer Key for Office 365</span></span>](customer-key-set-up.md)

- [<span data-ttu-id="48265-291">Управление ключом клиента для Office 365</span><span class="sxs-lookup"><span data-stu-id="48265-291">Manage Customer Key for Office 365</span></span>](customer-key-manage.md)

- [<span data-ttu-id="48265-292">Вращение или поворот ключа клиента или ключа доступности</span><span class="sxs-lookup"><span data-stu-id="48265-292">Roll or rotate a Customer Key or an availability key</span></span>](customer-key-availability-key-roll.md)
