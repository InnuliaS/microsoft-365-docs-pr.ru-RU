---
title: Общие сведения о хранении, зависящем от возникновения события
f1.keywords:
- NOCSH
ms.author: cabailey
author: cabailey
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Priority
ms.collection:
- M365-security-compliance
search.appverid:
- MOE150
- MET150
description: С помощью меток хранения можно создать период хранения на основе момента возникновения события определенного типа, после чего начинается период хранения. Ко всему содержимому с меткой хранения, присвоенной для события соответствующего типа, применяются действия по хранению, определенные в метке. Хранение на основе событий обычно используется как часть процесса управления записями.
ms.openlocfilehash: 100381d87c51a8ef403a88f19159235081c2a8df
ms.sourcegitcommit: 330e9baf02b5bc220d61f777c2338814459626ec
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/27/2020
ms.locfileid: "44385010"
---
# <a name="overview-of-event-driven-retention"></a>Общие сведения о хранении, зависящем от возникновения события

>*[Руководство по лицензированию Microsoft 365 для обеспечения безопасности и соответствия требованиям](https://aka.ms/ComplianceSD).*

Когда вы сохраняете контент, срок хранения часто зависит от возраста контента - например, вы можете хранить документы в течение семи лет после их создания, а затем удалять их. Но с метками хранения в Microsoft 365 вы также можете основывать период хранения на том, когда происходит определенный тип события. Событие инициирует начало периода хранения, и весь контент с меткой хранения, примененной для этого типа события, получает действия по сохранению метки, примененные к ним.
  
Метки с хранением, зависящим от возникновения события, можно использовать, например, в таких случаях:
  
- **Уход сотрудника из организации.** Предположим, что записи о сотруднике нужно хранить в течение 10 лет с момента его ухода из организации. Через 10 лет все документы, касающиеся найма и результатов работы этого сотрудника, расторжения трудовых отношений с ним нужно уничтожить. Событие, активирующее начало 10-летнего периода хранения, — это уход сотрудника из организации. 
    
- **Завершение срока действия контракта.** Предположим, что все записи, относящиеся к контрактам, нужно хранить пять лет после окончания срока действия контракта. Событие, активирующее начало 5-летнего периода хранения, — это завершение срока действия контракта. 
    
- **Время существования продукта.** У вашей организации могут быть требования к хранению, связанные с датой последнего выпуска продуктов, в отношении такого контента, как технические спецификации. В таком случае последний выпуск — это событие, активирующее начало периода хранения. 
    
Хранение, зависящее от возникновения события, обычно используется в процессе управления записями. Это означает следующее:
  
- Метки, основанные на событиях, обычно относят содержимое к категории записей. Дополнительные сведения см. в статье [Использование средства "Поиск контента" для поиска содержимого с определенной меткой хранения](labels.md#using-content-search-to-find-all-content-with-a-specific-retention-label-applied-to-it).
    
- Документ, который был объявлен записью, но для которого событие-триггер еще не наступило, хранится в течение неограниченного времени (окончательно удалить записи невозможно), пока событие не активирует период его хранения.
    
- Метки на основе событий обычно запускают проверку перед ликвидацией в конце срока хранения: управляющий записями может вручную проверить и ликвидировать содержимое. Дополнительные сведения см. в статье [Ликвидация содержимого](disposition.md).
    
Метка хранения на основе события имеет те же возможности, что и любая метка хранения в Microsoft 365. Дополнительные сведения см. В разделе [Обзор меток](labels.md).

## <a name="understanding-the-relationship-between-event-types-labels-events-and-asset-ids"></a>Взаимосвязь между типами событий, метками, событиями и идентификаторами ресурсов

Чтобы успешно использовать управляемое событиями хранение, важно понимать взаимосвязь между типами событий, метками хранения, событиями и идентификаторами активов, как показано на диаграммах и в следующем пояснении: 
  
![Схема взаимосвязей между типами событий, метками, событиями и идентификаторами ресурсов](../media/a5141a6b-61ca-4a60-9ab0-24e6bb45bbdb.png)
  
![Схема взаимосвязей между типами событий, метками, событиями и идентификаторами ресурсов](../media/ce89a91f-49aa-4b5a-933c-ac3a13dccd5d.png)
  
1. Вы создаете метки хранения для разных типов контента, а затем связываете их с типом события. Например, метки хранения для различных типов файлов и записей продукта связаны с типом события с именем Product Lifetime, поскольку эти записи должны храниться в течение 10 лет с момента окончания срока действия продукта.
    
2. Пользователи (обычно менеджеры записей) применяют эти метки хранения к контенту и (для документов SharePoint и OneDrive) вводят идентификатор ресурса для каждого элемента. В этом примере идентификатор актива - это название продукта или код, используемый организацией. Таким образом, каждой записи продукта присваивается метка хранения, и каждая запись имеет свойство, которое содержит идентификатор актива. Диаграмма представляет **весь контент** для всех записей продукта в организации, и каждый элемент имеет идентификатор актива продукта, чья запись это. 
    
3. "Время существования продукта" — это тип события, которое наступает при завершении существования продукта. Когда возникает такого рода события, т. е. когда время существования продукта заканчивается, создается событие, для которого указывается следующее:
    
  - Идентификатор ресурса (для документов SharePoint и OneDrive).
    
  - Ключевые слова (для элементов Exchange). В этом примере организация использует код продукта в сообщениях, содержащих записи продукта, поэтому ключевое слово для элементов Exchange совпадает с идентификатором ресурса для документов SharePoint и OneDrive.
    
  - Дата возникновения события. С этой даты начинается период хранения, она может быть текущей, прошедшей или будущей.
    
4. После создания события эта дата события синхронизируется со всем контентом, который имеет метку хранения этого типа и которая содержит указанный идентификатор актива или ключевое слово. Как и любая метка хранения, эта синхронизация может занять до 7 дней. На предыдущей диаграмме все элементы, обведенные красным, имеют период хранения, инициируемый этим событием. Другими словами, когда срок действия этого продукта истекает, это событие запускает период хранения для записей этого продукта.
    
Важно понимать, что если вы не укажете идентификатор ресурса или ключевые слова для события, то для **всего содержимого** с меткой хранения этого типа будет иметься период хранения, инициируемый событием. Это означает, что на предыдущей диаграмме весь контент начал бы сохраняться. Это может быть не то, что вы намерены. 
  
Наконец, помните, что каждая метка хранения имеет свои собственные настройки хранения. В этом примере все они указывают 10 лет, но для события возможно инициировать метки хранения, где каждая метка имеет свой период хранения.
  
## <a name="how-to-set-up-event-driven-retention"></a>Настройка хранения, зависящего от возникновения события

Рабочий процесс высокого уровня для удержания на основе событий:
  
![Схема, иллюстрирующая рабочий процесс для настройки хранения, зависящего от возникновения события](../media/event-based-retention-process.png)
  
> [!TIP]
> Подробный сценарий использования управляемых свойств в SharePoint для автоматического применения меток хранения и реализации хранения, зависящего от возникновения события, см. в статье [Управление жизненным циклом документов SharePoint с метками хранения](auto-apply-retention-labels-scenario.md).

### <a name="step-1-create-a-label-whose-retention-period-is-based-on-an-event"></a>Шаг 1. Создайте метку, период хранения которой зависит от возникновения события

В Центре соответствия требованиям Microsoft 365, Центре безопасности Microsoft 365 или Центре безопасности и соответствия требованиям в области навигации слева выберите **Классификации** > **Метки хранения** >  вкладка **Метки** > **Создать метку**.
  
При создании метки включите хранение, а затем выберите параметр, показанный ниже, для хранения или удаления содержимого в связи с событием. Это означает, что параметры хранения не вступят в силу, пока не будет выполнен шаг 5 (создание события на странице **События**). 
  
Обратите внимание, что управляемое событиями хранение обычно используется для контента, который классифицируется как запись. По этой причине, когда вы создаете метки хранения на основе события, вы обычно выбираете опцию **Использовать метку, чтобы классифицировать контент как "Запись"**.
  
Обратите внимание также на то, что для хранения, зависящего от возникновения события, требуются настройки, согласно которым будет выполняться:
  
- хранение содержимого;
    
- автоматическое удаление содержимого или активация проверки перед ликвидацией в конце периода хранения.
    
![Возможность создать метку на основе события](../media/a4902281-5196-4194-9737-f30231d95861.png)
  
### <a name="step-2-choose-an-event-type-for-that-label"></a>Шаг 2. Выберите тип события для такой метки

Когда вы в настройках метки выберите **Событие** в качестве условия для метки, отобразится ссылка **Выберите тип события**. Тип события — это его простое описание, которое можно связать с меткой.
  
Например, если вы создадите тип события с именем Product Lifetime, вы создадите метки хранения на основе событий с именами, которые описывают, к каким типам контента вы хотите применить метки, например «Файлы разработки продукта» или «Бизнес продукта». записи решений ".
  
Обратите внимание, что после выбора типа события и создания метки хранения тип события не может быть изменен.
  
![Возможности создания или выбора типа события](../media/8b7afe79-72cb-462e-81d4-b5ddbe899dbc.png)
  
### <a name="step-3-publish-or-auto-apply-the-event-based-retention-labels"></a>Шаг 3. Публикация или автоматическое применение меток хранения на основе событий

Метку хранения на основе события, как и любую другую метку хранения, необходимо [автоматически применить к событию или опубликовать](create-retention-labels.md), чтобы ее можно было применять вручную.

> [!NOTE]
> Если выбрать метку хранения на основе события на вкладке **Управление записями** > **План хранения** или **Управление информацией** > **Метки**, кнопка **Автоматически применить метку** будет недоступна.
> 
> Вместо этой кнопки используйте параметр **Автоматически применить метку**, расположенный над списком меток или политик в одном из следующих расположений:
> - **Управление записями** >  вкладка **Политики меток**
> - **Управление информацией** >  вкладка **Метки** или вкладка **Политики меток**

### <a name="step-4-enter-an-asset-id"></a>Шаг 4. Введите идентификатор ресурса

После применения к содержимому метки на основе события можно ввести идентификатор ресурса для каждого элемента. Например, ваша организация может использовать следующее:
  
- коды продуктов для хранения содержимого, касающегося только определенного продукта;
    
- коды проектов для хранения содержимого, касающегося только определенного проекта;
    
- идентификаторы сотрудников для хранения содержимого, касающегося только конкретного лица.
    
Важно понимать, что ИД ресурса — это просто одно из свойств документа в SharePoint и OneDrive для бизнеса. Ваша организация уже может использовать другие свойства и идентификаторы документов для классификации содержимого. Если это так, вы также можете использовать эти свойства и значения при создании события - см. Следующий шаг 6. Важно то, что необходимо использовать определенное сочетание "свойство:значение" в свойствах документа, чтобы связать элемент с типом события.
  
![Текстовое поле для ввода идентификатора ресурса](../media/6d31628e-7162-4370-a8d7-de704aafa350.png)
  
### <a name="step-5-create-an-event"></a>Шаг 5. Создайте событие

Когда возникнет определенный экземпляр события такого типа (например, когда завершится время существования продукта), перейдите на страницу **Управление записями** > **События** в Центре безопасности и соответствия требованиям и создайте событие. Вам нужно вручную активировать событие, создав его.
  
### <a name="step-6-choose-the-same-event-type-used-by-the-label-in-step-2"></a>Шаг 6. Выберите тип события, который использовался для метки из описания шага 2

Когда вы создаете событие, выберите тот же тип события, который используется меткой хранения на шаге 2, например Product Lifetime. Период хранения будет инициирован только для контента с метками хранения, примененными к нему с таким типом события.
  
![Возможность выбора типа события в параметрах события](../media/11663591-5628-419e-9537-61eb8f5c741f.png)
  
### <a name="step-7-enter-keywords-or-an-asset-id"></a>Шаг 7. Введите ключевые слова или идентификатор ресурса

Теперь нужно сузить область поиска содержимого, указав идентификаторы ресурсов для содержимого SharePoint и OneDrive или ключевые слова для содержимого Exchange. Для идентификаторов ресурсов хранение будет применяться только к содержимому с указанной парой "свойство-значение". Если не ввести идентификатор ресурса, **ко всему содержимому** с метками такого типа события будет применена та же дата для хранения. 
  
Важно понимать, что идентификатор ресурса — это лишь одно из свойств документа в SharePoint и OneDrive для бизнеса. Если вы используете свойство Asset ID, в поле для идентификаторов ресурсов следует ввести ComplianceAssetID:\<value\>, как показано ниже.
  
Возможно, ваша организация уже применила другие свойства и идентификаторы к документам, связанным с таким типом события. Например, если вам нужно найти записи для конкретного продукта, идентификатор может представлять собой сочетание пользовательского свойства ProductID и значения "XYZ". В этом случае вам нужно ввести ProductID:XYZ в поле для идентификаторов ресурсов, как показано ниже.
  
Для элементов Exchange можно добавить ключевые слова. Вы можете уточнить запрос с помощью таких операторов поиска, как AND, OR и NOT. Дополнительные сведения об этих операторах см. в статье [Запросы по ключевым словам и условия для средства "Поиск контента"](keyword-queries-and-search-conditions.md).
  
Наконец, выберите дату, когда произошло событие; эта дата используется как начало срока хранения. После создания события эта дата события синхронизируется со всем содержимым с меткой хранения этого типа события, идентификатором ресурса и ключевыми словами. Как и любая метка хранения, эта синхронизация может занять до 7 дней.
  
![Страница параметров события](../media/40d3c9db-f624-49a5-b38a-d16bcce20231.png)
  
## <a name="use-content-search-to-find-all-content-with-a-specific-label-or-asset-id"></a>Использование средства "Поиск контента" для поиска всего содержимого с определенной меткой или определенным идентификатором ресурса

После назначения меток хранения контенту можно использовать поиск контента, чтобы найти весь контент, классифицированный с определенной меткой хранения или содержащий определенный идентификатор ресурса.
  
Применение запросов на поиск содержимого:
  
- Чтобы найти все содержимое с определенной меткой хранения, выберите условие **Метка соответствия**, затем введите полное имя метки или часть имени метки и используйте подстановочный знак. 
    
- Чтобы найти все содержимое с определенным идентификатором ресурса, введите свойство **ComplianceAssetID** и значение (например, ComplianceAssetID:\<value\>). 
    
Дополнительные сведения см. в статье [Запросы по ключевым словам и условия для средства "Поиск контента"](keyword-queries-and-search-conditions.md).
  
## <a name="permissions"></a>Разрешения

Чтобы получить доступ к странице **События**, проверяющие должны быть членами группы ролей, включающей роли **Управление ликвидацией** и **Журналы аудита только для просмотра**. Рекомендуем создать новую группу ролей под названием "Проверяющие ликвидацию" и добавить в нее сначала эти две роли, а затем членов. 
  
Дополнительные сведения см. в статье [Предоставление пользователям доступа к Центру безопасности и соответствия требованиям](../security/office-365-security/grant-access-to-the-security-and-compliance-center.md).
  
## <a name="automate-events-by-using-powershell"></a>Автоматизация событий с помощью PowerShell

В центре администрирования можно создать события только вручную. Автоматически запускать событие в момент его возникновения невозможно. Тем не менее можно использовать Rest API для автоматической активации событий. Дополнительные сведения см. в статье [Автоматизация хранения на основе событий](automate-event-driven-retention.md).

Кроме того, с помощью сценария PowerShell можно автоматизировать хранение на основе событий из бизнес-приложений. Командлеты PowerShell, доступные для хранения на основе событий:
  
- [Get-ComplianceRetentionEventType](https://go.microsoft.com/fwlink/?linkid=873002)
    
- [New-ComplianceRetentionEventType](https://go.microsoft.com/fwlink/?linkid=873004)
    
- [Remove-ComplianceRetentionEventType](https://go.microsoft.com/fwlink/?linkid=873005)
    
- [Set-ComplianceRetentionEventType](https://go.microsoft.com/fwlink/?linkid=873006)
    
- [Get-ComplianceRetentionEvent](https://go.microsoft.com/fwlink/?linkid=873001)
    
- [New-ComplianceRetentionEvent](https://go.microsoft.com/fwlink/?linkid=873003)
    

